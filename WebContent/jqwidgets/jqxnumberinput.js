/*
Copyright (c) 2012 jqWidgets.
http://jqwidgets.com/license/
*/

(function(a){a.jqx.jqxWidget("jqxNumberInput","",{});a.jqx.textInput={};a.extend(a.jqx.textInput,{addHandler:function(b){a(b).data("lastValue",a(b).val());a(b).bind("keyup.textchange",a.jqx.textInput.handler);a(b).bind("cut.textchange paste.textchange input.textchange",a.jqx.textInput.delayedHandler)},removeHandler:function(b){a(b).unbind(".textchange")},handler:function(b){a.jqx.textInput.triggerIfChanged(a(this))},delayedHandler:function(c){var b=a(this);setTimeout(function(){a.jqx.textInput.triggerIfChanged(b)},25)},triggerIfChanged:function(d){var e=d.val();var c=d.data("lastValue");if(e!==d.data("lastValue")){d.trigger("textchange",[d.data("lastValue")]);var b=false;if(d.val()===""&&d.val()!=c){b=true;d.data("emptyValue",true)}else{b=false;d.data("emptyValue",false)}d.trigger("showPlaceHolder",b);d.data("lastValue",e)}}});a.extend(a.jqx._jqxNumberInput.prototype,{defineInstance:function(){this.value=null;this.decimal=0;this.min=0;this.max=99999999;this.width=null;this.validationMessage="Invalid value";this.height=50;this.textAlign="right";this.readOnly=false;this.promptChar="_";this.decimalDigits=2;this.decimalSeparator=".";this.groupSeparator=",";this.groupSize=3;this.symbol="";this.symbolPosition="left";this.digits=8;this.negative=false;this.negativeSymbol="-";this.disabled=false;this.inputMode="advanced";this.spinbuttons=false;this.spinbuttonswidth=18;this.spinbuttonsstep=1;this.spinmode="advanced";this.events=["valuechanged","textchanged","mousedown","mouseup","keydown","keyup","keypress",];this.invalidArgumentExceptions=["invalid argument exception"]},createInstance:function(h){this.host.attr({role:"numberInput"});this.tooltip=null;this.host.addClass(this.toThemeProperty("jqx-input"));this.host.addClass(this.toThemeProperty("jqx-rc-all"));if(this.spinbuttons){this._spinbuttons()}else{this.numberInput=a("<input type='textarea'/>").appendTo(this.host);this.numberInput.addClass(this.toThemeProperty("jqx-input-content"))}var g=a.data(this.host[0],"jqxNumberInput");g.jqxNumberInput=this;var l=this;if(this.host.parents("form").length>0){this.host.parents("form").bind("reset",function(){setTimeout(function(){l.setDecimal(0)},10)})}if(this.host.jqxTooltip){var n=this.host.append(a("<div></div>"));var b=n.jqxTooltip();this.tooltip=a.data(b[0],"jqxTooltip").instance;this.tooltip.disabled=true}this.propertyChangeMap.disabled=function(q,s,r,u){if(o.disabled){o.numberInput.addClass(o.toThemeProperty("jqx-input-disabled"));o.numberInput.attr("disabled",true)}else{o.host.removeClass(o.toThemeProperty("jqx-input-disabled"));o.numberInput.attr("disabled",false)}if(o.spinbuttons&&o.host.jqxRepeatButton){o.upbutton.jqxRepeatButton({disabled:o.disabled});o.downbutton.jqxRepeatButton({disabled:o.disabled})}};if(this.disabled){this.numberInput.addClass(this.toThemeProperty("jqx-input-disabled"));this.numberInput.attr("disabled",true)}this.selectedText="";this.decimalSeparatorPosition=-1;var d=this.element.id;var e=this.element;var o=this;this.addHandler(this.numberInput,"mousedown",function(q){return o._raiseEvent(2,q)});var c=a.jqx.mobile.isOperaMiniMobileBrowser();if(c){this.inputMode="simple";var f=a.jqx.mobile.isOperaMiniBrowser();if(f){o.numberInput.attr("readonly",true)}this.addHandler(a(document),"click",o._exitSimpleInputMode,o)}this.addHandler(this.numberInput,"focus",function(q){if(o.inputMode=="simple"){o._enterSimpleInputMode(q,o);return false}a.data(o.numberInput,"selectionstart",o._selection().start)});this.addHandler(this.numberInput,"blur",function(q){if(o.inputMode=="simple"){o._exitSimpleInputMode(q,o,false);return false}});this.addHandler(this.numberInput,"mouseup",function(q){return o._raiseEvent(3,q)});this.addHandler(this.numberInput,"keydown",function(q){return o._raiseEvent(4,q)});this.addHandler(this.numberInput,"keyup",function(q){return o._raiseEvent(5,q)});this.addHandler(this.numberInput,"keypress",function(q){return o._raiseEvent(6,q)});this.self=this;this.oldValue=this._value();this.items=new Array();this._initializeLiterals();this._render();if(this.value!=null){this.decimal=this.value}this.setDecimal(this.decimal);var l=this;setTimeout(function(){l._render()},100);if(a.jqx.mobile.isChromeMobileBrowser()){this.addHandler(this.numberInput,"input",function(q){window.setTimeout(function(){var s=l._selection();if(s.start<l.numberInput.val().length){l._setSelectionStart(s.start+1)}else{var r=l.numberInput.val();l.numberInput.val(r+"0");l._setSelectionStart(s.start+1)}l._handleBackspace()},10);return false})}},_spinbuttons:function(){if(this.host.jqxRepeatButton){this.numberInput=a("<input style='float: left;' type='textarea'/>");this.numberInput.appendTo(this.host);this.numberInput.addClass(this.toThemeProperty("jqx-input-content"));this.spincontainer=a('<div style="float: left; height: 100%; overflow: hidden; position: relative;"></div>');this.host.append(this.spincontainer);this.upbutton=a('<div style="padding: 0px; margin-left: -1px; position: relative;"><div style="width: 100%; height: 100%;"></div></div>');this.spincontainer.append(this.upbutton);this.upbutton.jqxRepeatButton({overrideTheme:true,disabled:this.disabled,roundedCorners:"top-right"});this.downbutton=a('<div style="padding: 0px; margin-left: -1px; position: relative;"><div style="width: 100%; height: 100%;"></div></div>');this.spincontainer.append(this.downbutton);this.downbutton.jqxRepeatButton({overrideTheme:true,disabled:this.disabled,roundedCorners:"bottom-right"});var b=this;this.downbutton.addClass(this.toThemeProperty("jqx-scrollbar-button-state-normal"));this.upbutton.addClass(this.toThemeProperty("jqx-scrollbar-button-state-normal"));this.addHandler(this.downbutton,"mouseup",function(c){if(!b.disabled){b.downbutton.removeClass(b.toThemeProperty("jqx-scrollbar-button-state-pressed"))}});this.addHandler(this.upbutton,"mouseup",function(c){if(!b.disabled){b.upbutton.removeClass(b.toThemeProperty("jqx-scrollbar-button-state-pressed"))}});this.addHandler(this.downbutton,"mousedown",function(c){if(!b.disabled){b.downbutton.addClass(b.toThemeProperty("jqx-scrollbar-button-state-pressed"));return false}});this.addHandler(this.upbutton,"mousedown",function(c){if(!b.disabled){b.upbutton.addClass(b.toThemeProperty("jqx-scrollbar-button-state-pressed"));return false}});this.upbutton.hover(function(){if(!b.disabled){b.upbutton.addClass(b.toThemeProperty("jqx-scrollbar-button-state-hover"))}},function(){b.upbutton.removeClass(b.toThemeProperty("jqx-scrollbar-button-state-hover"))});this.downbutton.hover(function(){if(!b.disabled){b.downbutton.addClass(b.toThemeProperty("jqx-scrollbar-button-state-hover"))}},function(){b.downbutton.removeClass(b.toThemeProperty("jqx-scrollbar-button-state-hover"))});this.upbutton.css("border-width","0px");this.downbutton.css("border-width","0px");if(this.disabled){this.upbutton[0].disabled=true;this.downbutton[0].disabled=true}else{this.upbutton[0].disabled=false;this.downbutton[0].disabled=false}this.spincontainer.addClass(this.toThemeProperty("jqx-input"));this.spincontainer.css("border-width","0px");this.spincontainer.css("border-left-width","1px");this._upArrow=this.upbutton.find("div");this._downArrow=this.downbutton.find("div");this._upArrow.addClass(this.toThemeProperty("icon-arrow-up"));this._downArrow.addClass(this.toThemeProperty("icon-arrow-down"));var b=this;this._upArrow.hover(function(){if(!b.disabled){b._upArrow.addClass(b.toThemeProperty("icon-arrow-up-hover"))}},function(){b._upArrow.removeClass(b.toThemeProperty("icon-arrow-up-hover"))});this._downArrow.hover(function(){if(!b.disabled){b._downArrow.addClass(b.toThemeProperty("icon-arrow-down-hover"))}},function(){b._downArrow.removeClass(b.toThemeProperty("icon-arrow-down-hover"))});this.addHandler(this.downbutton,"click",function(){if(b._selection().start==0){b._setSelectionStart(b.numberInput.val().length)}b.spinDown()});this.addHandler(this.upbutton,"click",function(){if(b._selection().start==0){b._setSelectionStart(b.numberInput.val().length)}b.spinUp()})}},spinDown:function(){var l=this;if(l.inputMode!="advanced"){l._exitSimpleInputMode(new jQuery.Event(),l,false)}if(!l.disabled){var n=this._selection();var g=parseFloat(l.decimal);if(l.spinbuttonsstep<0){l.spinbuttonsstep=1}var c=parseInt(l.decimal)+l.spinbuttonsstep;c=c.toString().length;var e=c<=l.digits;if(l.spinmode!="advanced"){if(g>0&&g+l.spinbuttonsstep<=l.max&&e){var r=1;for(i=0;i<l.decimalDigits;i++){r=r*10}var d=(r*g)-(r*l.spinbuttonsstep);d=d/r;if(d<0){d=0}l.setDecimal(d)}}else{var o=this._getspindecimal();var h=this._getSeparatorPosition();var g=parseFloat(o.decimal);if(l.spinbuttonsstep<0){l.spinbuttonsstep=1}var c=parseInt(g)+l.spinbuttonsstep;c=c.toString().length;var e=c<=l.digits;var r=1;var b=o.decimal.indexOf(this.decimalSeparator);if(b!=-1){var f=o.decimal.length-b-1;var r=1;for(i=0;i<f;i++){r=r*10}g-=new Number(l.spinbuttonsstep/r);if(g<0){g=0}g=g.toFixed(f);var b=g.toString().indexOf(this.decimalSeparator);if(b==-1){g=g.toString()+"."}var q=g.toString()+o.afterdecimal;q=new Number(q);q=q.toFixed(l.decimalDigits);l.setDecimal(q)}else{if(g>0&&g+l.spinbuttonsstep<=l.max&&e){var d=(r*g)-(r*l.spinbuttonsstep);d=d/r;var q=d.toString()+o.afterdecimal;if(q<0){q=0}l.setDecimal(q)}}}this._setSelectionStart(n.start)}},_getspindecimal:function(){var d=this._selection();var c="";var g=this._getSeparatorPosition();var b=this._getVisibleItems();var e=this._getHiddenPrefixCount();if(this.numberInput.val().length==d.start&&d.length==0){this._setSelection(d.start,d.start+1);d=this._selection()}for(i=0;i<d.start;i++){if(b[i].canEdit&&b[i].character!=this.promptChar){c+=b[i].character}else{if(!b[i].canEdit&&this.decimalSeparatorPosition!=-1&&b[i]==b[this.decimalSeparatorPosition-e]){if(c.length==0){c="0"}c+=b[i].character}}}var f="";for(i=d.start;i<b.length;i++){if(b[i].canEdit&&b[i].character!=this.promptChar){f+=b[i].character}else{if(!b[i].canEdit&&this.decimalSeparatorPosition!=-1&&b[i]==b[this.decimalSeparatorPosition-e]){f+=b[i].character}}}return{decimal:c,afterdecimal:f}},spinUp:function(){var l=this;if(l.inputMode!="advanced"){l._exitSimpleInputMode(new jQuery.Event(),l,false)}if(!l.disabled){var n=this._selection();var g=parseFloat(l.decimal);if(l.spinbuttonsstep<0){l.spinbuttonsstep=1}var c=parseInt(l.decimal)+l.spinbuttonsstep;c=c.toString().length;var e=c<=l.digits;if(l.spinmode!="advanced"){if(g+l.spinbuttonsstep<=l.max&&e){var r=1;for(i=0;i<l.decimalDigits;i++){r=r*10}var d=(r*g)+(r*l.spinbuttonsstep);d=d/r;l.setDecimal(d)}}else{var o=this._getspindecimal();var h=this._getSeparatorPosition();var g=parseFloat(o.decimal);if(l.spinbuttonsstep<0){l.spinbuttonsstep=1}var c=parseInt(g)+l.spinbuttonsstep;c=c.toString().length;var e=c<=l.digits;var r=1;var b=o.decimal.indexOf(this.decimalSeparator);if(b!=-1){var f=o.decimal.length-b-1;var r=1;for(i=0;i<f;i++){r=r*10}g+=new Number(l.spinbuttonsstep/r);g=g.toFixed(f);var b=g.toString().indexOf(this.decimalSeparator);if(b==-1){g=g.toString()+"."}var q=g.toString()+o.afterdecimal;q=new Number(q);q=q.toFixed(l.decimalDigits);l.setDecimal(q)}else{if(g+l.spinbuttonsstep<=l.max&&e){var d=(r*g)+(r*l.spinbuttonsstep);d=d/r;var q=d.toString()+o.afterdecimal;l.setDecimal(q)}}}this._setSelectionStart(n.start)}},_exitSimpleInputMode:function(c,q,h){if(q==undefined){q=c.data}if(q==null){return}if(h==undefined){if(c.target!=null&&q.element!=null){if((c.target.id!=undefined&&c.target.id.toString().length>0&&q.host.find("#"+c.target.id).length>0)||c.target==q.element){return}}var f=q.host.offset();var e=f.left;var g=f.top;var d=q.host.width();var o=q.host.height();var r=a(c.target).offset();if(r.left>=e&&r.left<=e+d){if(r.top>=g&&r.top<=g+o){return}}}if(a.jqx.mobile.isOperaMiniBrowser()){q.numberInput.attr("readonly",true)}if(q.disabled||q.readOnly){return}var n=a.data(q.numberInput,"simpleInputMode");if(n==null){return}var l=q.numberInput.val();var b=l.indexOf("-")!=-1;if(b){q.items[0].character=q.negativeSymbol[0]}else{q.items[0].character=""}if(l==""){l="0"}if(!isNaN(parseFloat(l))){l=Math.abs(parseFloat(l)).toString();q.setDecimal(l.toString())}else{q.setDecimal(q.decimal)}a.data(q.numberInput,"simpleInputMode",null);return false},_enterSimpleInputMode:function(e,d){if(d==undefined){d=e.data}if(d==null){return}var c=d.getvalue("negative");var b=d.decimal;if(c){if(b>0){b=-b}}d.numberInput.val(b);a.data(d.numberInput,"simpleInputMode",true);if(a.jqx.mobile.isOperaMiniBrowser()){d.numberInput.attr("readonly",false)}},setvalue:function(b,c){if(this[b]!=undefined){this[b]=c;this.propertyChangedHandler(this,b,c,c)}},getvalue:function(b){if(b=="decimal"){if(this.negative!=undefined&&this.negative==true){return -this[b]}}if(b in this){return this[b]}return null},_getString:function(){var b="";for(i=0;i<this.items.length;i++){var c=this.items[i].character;b+=c}return b},_literal:function(d,b,c,e){return{character:d,regex:b,canEdit:c,isSeparator:e}},_initializeLiterals:function(){var f=0;var d=this.negativeSymbol.length;for(i=0;i<d;i++){var e=this.negativeSymbol.substring(i,i+1);var l="";var b=false;var n=null;if(this.negative){n=this._literal(e,l,b,false)}else{n=this._literal("",l,b,false)}this.items[f]=n;f++}var c=this.symbol.length;if(this.symbolPosition=="left"){for(i=0;i<c;i++){var e=this.symbol.substring(i,i+1);var l="";var b=false;var n=this._literal(e,l,b,false);this.items[f]=n;f++}}var g=this.digits%this.groupSize;if(g==0){g=this.groupSize}for(i=0;i<this.digits;i++){var e=this.promptChar;var l="\\d";var b=true;var n=this._literal(e,l,b,false);this.items[f]=n;f++;if(i<this.digits-1&&this.groupSeparator!=undefined&&this.groupSeparator.length>0){g--;if(g==0){g=this.groupSize;var h=this._literal(this.groupSeparator,"",false,false);this.items[f]=h;f++}}else{if(i==this.digits-1){n.character=0}}}this.decimalSeparatorPosition=-1;if(this.decimalDigits!=undefined&&this.decimalDigits>0){var e=this.decimalSeparator;if(e.length==0){e="."}var n=this._literal(e,"",false,true);this.items[f]=n;this.decimalSeparatorPosition=f;f++;for(i=0;i<this.decimalDigits;i++){var q=0;var l="\\d";var o=this._literal(q,l,true,false);this.items[f]=o;f++}}if(this.symbolPosition=="right"){for(i=0;i<c;i++){var e=this.symbol.substring(i,i+1);var l="";var b=false;var n=this._literal(e,l,b);this.items[f]=n;f++}}},_match:function(c,b){var d=new RegExp(b,"i");return d.test(c)},_raiseEvent:function(e,w){var v=this.events[e];var n={};n.owner=this;var u=w.charCode?w.charCode:w.keyCode?w.keyCode:0;var x=true;var s=this.readOnly;var o=this;if(e==3||e==2){if(!this.disabled){if(this.inputMode!="simple"){this._handleMouse(w);if(a.jqx.mobile.isChromeMobileBrowser()){a.data(this.numberInput,"selectionstart",this._selection().start)}}else{this._enterSimpleInputMode(null,o)}}}if(e==0){if(this.tooltip!=null&&this.tooltip!=undefined&&this.validationMessage.length>0){var d=this.getvalue("decimal");if((this.max<d)||(this.min>d)){this.host.addClass(this.toThemeProperty("jqx-input-invalid"));var h=a.data(this.numberInput[0],"Tooltip");if(!this.tooltip.isOpen){this.tooltip.location="relative";this.tooltip.disabled=false;this.tooltip.open(this.numberInput,this.validationMessage);h=a.data(this.numberInput[0],"Tooltip");var b=a.data(this.numberInput[0],"TooltipBounds");h.css({top:parseInt(b.position.top)+parseInt(b.elementHeight)+3,left:parseInt(b.position.left)+parseInt(b.elementWidth)-parseInt(b.width)})}var g=a(h).find(".jqx-tooltip-content",true)[0];if(g!=null){g.className=this.toThemeProperty("jqx-tooltip-content-invalid")}}else{var h=a.data(this.numberInput[0],"Tooltip");if(h!=null){this.tooltip.events.closed=function(){var y=a(h).find(".jqx-tooltip-content-invalid",true)[0];if(y!=null){y.className=this.toThemeProperty("jqx-tooltip-content")}}}this.tooltip.close(this.numberInput[0]);this.host.removeClass(this.toThemeProperty("jqx-input-invalid"));this.host.addClass(this.toThemeProperty("jqx-input"));this.host.addClass(this.toThemeProperty("jqx-rc-all"));this.tooltip.disabled=true}}}var c=new jQuery.Event(v);c.owner=this;n.value=this.getvalue("decimal");n.text=this.numberInput.val();c.args=n;x=this.host.trigger(c);var o=this;if(this.inputMode!="simple"){if(e==4){if(s||this.disabled){return false}if(a.jqx.mobile.isChromeMobileBrowser()){var r=o._selection();window.setTimeout(function(){var y=a.data(o.numberInput,"selectionstart");if(y!=null&&y!=r.start){a.data(o.numberInput,"selectionstart",r.start)}x=o._handleKeyDown(w,u)},25)}else{x=o._handleKeyDown(w,u)}}else{if(e==5){if(s||this.disabled){x=false}}else{if(e==6){if(s||this.disabled){return false}x=o._handleKeyPress(w,u)}}}}else{if(e==3||e==5||e==6){if(s||this.disabled){return false}var f=String.fromCharCode(u);var q=parseInt(f);var l=true;if(!w.ctrlKey&&!w.shiftKey){if(u>=65&&u<=90){l=false}}return l}}return x},_getEditRange:function(){var c=0;var b=0;for(i=0;i<this.items.length;i++){if(this.items[i].canEdit){c=i;break}}for(i=this.items.length-1;i>=0;i--){if(this.items[i].canEdit){b=i;break}}return{start:c,end:b}},_getVisibleItems:function(){var b=new Array();var c=0;for(i=0;i<this.items.length;i++){if(this.items[i].character.toString().length>0){b[c]=this.items[i];c++}}return b},_hasEmptyVisibleItems:function(){var b=this._getVisibleItems();for(i=0;i<b.length;i++){if(b[i].canEdit&&b[i].character==this.promptChar){return true}}return false},_getFirstVisibleNonEmptyIndex:function(){var b=this._getVisibleItems();for(i=0;i<b.length;i++){if(b[i].canEdit&&b[i].character!=this.promptChar){return i}}},_handleMouse:function(f,b){var d=this._selection();if(d.length<=1){var c=this._getFirstVisibleNonEmptyIndex();if(d.start<c){this._setSelectionStart(c)}}},_insertKey:function(n){this.numberInput[0].focus();var d=String.fromCharCode(n);var e=parseInt(d);if(isNaN(e)){return}var r=0;for(i=0;i<this.items.length;i++){if(this.items[i].character.length==0){r++}}var l=this._selection();if(a.jqx.mobile.isChromeMobileBrowser()){var f=a.data(this.numberInput,"selectionstart");if(f!=null){l.start=f;l.end=f}}var b=this;if(l.start>=0&&l.start<=this.items.length){var g=false;var h=this._getFirstVisibleNonEmptyIndex();if(l.start<h&&l.length==0){if(!isNaN(d)||d==" "){this._setSelectionStart(h);l=this._selection()}}var c=this._getFirstEditableItemIndex();var q=this._getLastEditableItemIndex();var o=this._getVisibleItems();a.each(o,function(z,D){if(l.start>z&&z!=o.length-1){return}var G=o[z];if(z>q){G=o[q]}if(isNaN(d)||d==" "){return}if(!G.canEdit){return}var C=b._getSeparatorPosition();if(b._match(d,G.regex)){if(!g&&l.length>0){for(j=l.start+r;j<l.end+r;j++){if(b.items[j].canEdit){if(j>C){b.items[j].character="0"}else{b.items[j].character=b.promptChar}}}var F=b._getString();g=true}var C=b._getSeparatorPosition();var A=b._hasEmptyVisibleItems();if(l.start<=C&&A){var x=z;if(b.decimalSeparatorPosition==-1&&l.start==C){x=z+1}var w="";for(p=0;p<x;p++){if(o[p].canEdit&&o[p].character!=b.promptChar){w+=o[p].character}}w+=d;var y=b.decimal<1?1:0;if(l.start==C&&b.decimalSeparatorPosition!=-1){w+=b.decimalSeparator;y=0}for(p=x+y;p<o.length;p++){if(o[p].character==b.decimalSeparator&&o[p].isSeparator){w+=o[p].character}else{if(o[p].canEdit&&o[p].character!=b.promptChar){w+=o[p].character}}}w=parseFloat(w).toString();w=new Number(w);w=w.toFixed(b.decimalDigits);b.setvalue("decimal",w);var F=b._getString();if(l.end<C){b._setSelectionStart(l.end+y)}else{b._setSelectionStart(l.end)}if(l.length>=1){b._setSelectionStart(l.end)}if(l.length==b.numberInput.val().length){var s=b._moveCaretToDecimalSeparator();var E=b.decimalSeparatorPosition>=0?1:0;b._setSelectionStart(s-E)}}else{if(l.start<C||l.start>C){if(b.numberInput.val().length==l.start&&b.decimalSeparatorPosition!=-1){return false}else{if(b.numberInput.val().length==l.start&&b.decimalSeparatorPosition==-1&&!A){return false}}var w="";var u=false;for(p=0;p<z;p++){if(o[p].canEdit&&o[p].character!=b.promptChar){w+=o[p].character}if(o[p].character==b.decimalSeparator&&o[p].isSeparator){w+=o[p].character;u=true}}w+=d;var y=b.decimal<1?1:0;if(!u&&l.start==C-1){w+=b.decimalSeparator;u=true}for(p=z+1;p<o.length;p++){if(!u&&o[p].character==b.decimalSeparator&&o[p].isSeparator){w+=o[p].character}else{if(o[p].canEdit&&o[p].character!=b.promptChar){w+=o[p].character}}}b.setvalue("decimal",w);var F=b._getString();if(b.decimalSeparatorPosition<0&&G==o[q]){b._setSelectionStart(z);return false}var B=F.indexOf(b.symbol);var v=!b.getvalue("negative")?0:1;if(B<=v){B=F.length}if(l.start<B){b._setSelectionStart(z+1)}else{b._setSelectionStart(z)}if(l.length>=1){}if(l.length==b.numberInput.val().length){var s=b._moveCaretToDecimalSeparator();b._setSelectionStart(s-1)}}}return false}})}},_handleKeyPress:function(h,d){var f=this._selection();var b=this;if((h.ctrlKey&&d==97)||(h.ctrlKey&&d==65)){return true}if(d==8){if(f.start>0){b._setSelectionStart(f.start)}return false}if(d==46){if(f.start<this.items.length){b._setSelectionStart(f.start)}return false}if(d==45){var c=this.getvalue("negative");if(c==false){this.setvalue("negative",true)}else{this.setvalue("negative",false)}}if(a.browser.msie){this._insertKey(d)}var g=this._isSpecialKey(d);return g},_deleteSelectedText:function(){var d=this._selection();var c="";var f=this._getSeparatorPosition();var b=this._getVisibleItems();var e=this._getHiddenPrefixCount();if(this.numberInput.val().length==d.start&&d.length==0){this._setSelection(d.start,d.start+1);d=this._selection()}for(i=0;i<d.start;i++){if(b[i].canEdit&&b[i].character!=this.promptChar){c+=b[i].character}else{if(!b[i].canEdit&&this.decimalSeparatorPosition!=-1&&b[i]==b[this.decimalSeparatorPosition-e]){if(c.length==0){c="0"}c+=b[i].character}}}for(i=d.start;i<d.end;i++){if(i>f&&this.decimalSeparatorPosition!=-1){if(b[i].canEdit&&b[i].character!=this.promptChar){c+="0"}}else{if(!b[i].canEdit&&this.decimalSeparatorPosition!=-1&&b[i]==b[this.decimalSeparatorPosition-e]){if(c.length==0){c="0"}c+=b[i].character}}}for(i=d.end;i<b.length;i++){if(b[i].canEdit&&b[i].character!=this.promptChar){c+=b[i].character}else{if(!b[i].canEdit&&this.decimalSeparatorPosition!=-1&&b[i]==b[this.decimalSeparatorPosition-e]){if(c.length==0){c="0"}c+=b[i].character}}}this.setvalue("decimal",c);return d.length>0},_restoreInitialState:function(){var b=parseInt(this.decimalDigits);if(b>0){b+=2}for(k=this.items.length-1;k>this.items.length-1-b;k--){if(this.items[k].canEdit&&this.items[k].character==this.promptChar){this.items[k].character=0}}},clearDecimal:function(){for(i=0;i<this.items.length;i++){if(this.items[i].canEdit){this.items[i].character=this.promptChar}}this._restoreInitialState()},_saveSelectedText:function(){var c=this._selection();var d="";var b=this._getVisibleItems();if(c.start>0||c.length>0){for(i=c.start;i<c.end;i++){if(b[i].canEdit&&b[i].character!=this.promptChar){d+=b[i].character}else{if(b[i].isSeparator){d+=b[i].character}}}}window.clipboardData.setData("Text",d);return d},_pasteSelectedText:function(){var f=this._selection();var l="";var e=0;var d=window.clipboardData.getData("Text");if(d!=this.selectedText&&d.length>0){this.selectedText=window.clipboardData.getData("Text");if(this.selectedText==null||this.selectedText==undefined){return}}var c=f.start;var b=this._getVisibleItems();for(t=0;t<this.selectedText.length;t++){var g=parseInt(this.selectedText[t]);if(!isNaN(g)){var h=48+g;this._insertKey(h)}}},_getHiddenPrefixCount:function(){var b=0;if(!this.negative){b++}if(this.symbolPosition=="left"){for(i=0;i<this.symbol.length;i++){if(this.symbol.substring(i,i+1)==""){b++}}}return b},_getEditableItem:function(){var b=this._selection();for(i=0;i<this.items.length;i++){if(i<b.start){if(this.items[i].canEdit&&this.items[i].character!=this.promptChar){return this.items[i]}}}return null},_getEditableItems:function(){var c=new Array();var b=0;for(i=0;i<this.items.length;i++){if(this.items[i].canEdit){c[b]=this.items[i];b++}}return c},_getValidSelectionStart:function(b){for(i=this.items.length-1;i>=0;i--){if(this.items[i].canEdit&&this.items[i].character!=this.promptChar){return i}}return -1},_getEditableItemIndex:function(c){var e=this._selection();var f=this._getHiddenPrefixCount();var b=this._getVisibleItems();var d=e.start;var g=-1;for(i=0;i<d;i++){if(i<b.length&&b[i].canEdit){g=i+f}}if(g==-1&&e.length>0){d=e.end;for(i=0;i<d;i++){if(i<b.length&&b[i].canEdit){g=i+f;break}}}return g},_getEditableItemByIndex:function(b){for(k=0;k<this.items.length;k++){if(k>b){if(this.items[k].canEdit&&this.items[k].character!=this.promptChar){return k}}}return -1},_getFirstEditableItemIndex:function(){var b=this._getVisibleItems();for(m=0;m<b.length;m++){if(b[m].character!=this.promptChar&&b[m].canEdit&&b[m].character!="0"){return m}}return -1},_getLastEditableItemIndex:function(){var b=this._getVisibleItems();for(m=b.length-1;m>=0;m--){if(b[m].character!=this.promptChar&&b[m].canEdit){return m}}return -1},_moveCaretToDecimalSeparator:function(){for(i=this.items.length-1;i>=0;i--){if(this.items[i].character==this.decimalSeparator&&this.items[i].isSeparator){if(!this.negative){this._setSelectionStart(i);return i}else{this._setSelectionStart(i+1);return i}break}}return this.numberInput.val().length},_handleBackspace:function(){var e=this._selection();var f=this._getHiddenPrefixCount();var b=this._getEditableItemIndex()-f;if(b>=0){if(e.length==0&&b!=-1){this._setSelection(b,b+1)}var g=e.start>this._getSeparatorPosition()+1&&this.decimalSeparatorPosition>0;if(g){e=this._selection()}var d=this._deleteSelectedText();if(e.length<1||g){this._setSelectionStart(e.start)}else{if(e.length>=1){this._setSelectionStart(e.end)}}if(e.length==this.numberInput.val().length){var c=this._moveCaretToDecimalSeparator();this._setSelectionStart(c-1)}}else{this._setSelectionStart(e.start)}},_handleKeyDown:function(d,o){var n=this._selection();if((d.ctrlKey&&o==97)||(d.ctrlKey&&o==65)){return true}if((d.ctrlKey&&o==120)||(d.ctrlKey&&o==88)){this.selectedText=this._saveSelectedText(d);this._handleBackspace();return false}if((d.ctrlKey&&o==99)||(d.ctrlKey&&o==67)){this.selectedText=this._saveSelectedText(d);return false}if((d.ctrlKey&&o==122)||(d.ctrlKey&&o==90)){return false}if((d.ctrlKey&&o==118)||(d.ctrlKey&&o==86)||(d.shiftKey&&o==45)){this._pasteSelectedText();return false}if(n.start>=0&&n.start<this.items.length){var b=String.fromCharCode(o);var r=this.items[n.start]}if(o==8){this._handleBackspace();return false}if(o==190||o==110){this._moveCaretToDecimalSeparator();return false}if(o==188){var l=this.numberInput.val();for(i=n.start;i<l.length;i++){if(l[i]==this.groupSeparator){this._setSelectionStart(1+i);break}}return false}if(a.browser.msie==null){var b=String.fromCharCode(o);var g=parseInt(b);if(o>=96&&o<=105){g=o-96;o=o-48}if(!isNaN(g)){var f=this;f._insertKey(o);return false}}if(o==46){var q=this._getVisibleItems();if(n.start<q.length){var c=q[n.start].canEdit==false?2:1;if(n.length==0){this._setSelection(n.start+c,n.start+c+n.length)}this._handleBackspace();if(new Number(this.decimal)<1||n.start>this._getSeparatorPosition()){this._setSelectionStart(n.end+c)}else{if(n.start+1<this.decimalSeparatorPosition){this._setSelectionStart(n.end+c)}}}return false}if(o==37||o==39){if(a.jqx.mobile.isChromeMobileBrowser()){var c=o==37?-1:1;a.data(this.numberInput,"selectionstart",this._selection().start+c)}}if(o==38){this.spinUp();return false}else{if(o==40){this.spinDown();return false}}var h=this._isSpecialKey(o);if(!a.browser.mozilla){return true}return h},_isSpecialKey:function(b){if(b!=8&&b!=9&&b!=13&&b!=35&&b!=36&&b!=37&&b!=39&&b!=46){return false}return true},_selection:function(){if("selectionStart" in this.numberInput[0]){var f=this.numberInput[0];var g=f.selectionEnd-f.selectionStart;return{start:f.selectionStart,end:f.selectionEnd,length:g,text:f.value}}else{var c=document.selection.createRange();if(c==null){return{start:0,end:f.value.length,length:0}}var b=this.numberInput[0].createTextRange();var d=b.duplicate();b.moveToBookmark(c.getBookmark());d.setEndPoint("EndToStart",b);var g=c.text.length;return{start:d.text.length,end:d.text.length+c.text.length,length:g,text:c.text}}},_setSelection:function(d,b){if("selectionStart" in this.numberInput[0]){this.numberInput[0].focus();this.numberInput[0].setSelectionRange(d,b)}else{var c=this.numberInput[0].createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",d);c.select()}},_setSelectionStart:function(b){this._setSelection(b,b);a.data(this.numberInput,"selectionstart",b)},_render:function(){var c=parseInt(this.host.css("border-left-width"));var g=parseInt(this.host.css("border-left-width"));var f=parseInt(this.host.css("border-left-width"));var d=parseInt(this.host.css("border-left-width"));var l=parseInt(this.host.css("height"))-f-d;var e=parseInt(this.host.css("width"))-c-g;if(this.width!=null&&this.width.toString().indexOf("px")!=-1){e=this.width}else{if(this.width!=undefined&&!isNaN(this.width)){e=this.width}}if(this.height!=null&&this.height.toString().indexOf("px")!=-1){l=this.height}else{if(this.height!=undefined&&!isNaN(this.height)){l=this.height}}e=parseInt(e);l=parseInt(l);this.numberInput.css({"border-left-width":0,"border-right-width":0,"border-bottom-width":0,"border-top-width":0});this.numberInput.css("text-align",this.textAlign);var n=this.numberInput.css("font-size");if(!isNaN(l)){this.numberInput.css("height",parseInt(n)+4+"px")}if(!isNaN(e)){this.numberInput.css("width",e-2)}var h=l-2*f-2*d-parseInt(n);if(isNaN(h)){h=0}if(!isNaN(l)){this.host.height(l)}if(!isNaN(e)){this.host.width(e)}if(this.spinbuttons){e-=parseInt(this.spinbuttonswidth-2);this.spincontainer.width(this.spinbuttonswidth);this.upbutton.width(this.spinbuttonswidth+2);this.downbutton.width(this.spinbuttonswidth+2);this.upbutton.height(Math.round(l/2));this.downbutton.height(Math.round(l/2));this.spincontainer.width(this.spinbuttonswidth);this.numberInput.css("width",e-5);this.numberInput.css("margin-right","2px")}var b=h/2;if(a.browser.msie&&a.browser.version<8){b=h/4}this.numberInput.css("padding-left","0px");this.numberInput.css("padding-right","0px");this.numberInput.css("padding-top",b);this.numberInput.css("padding-bottom",h/2);this.numberInput.val(this._getString())},destroy:function(){this.element.removeClass("jqx-rc-all");this.numberInput.remove();this.element.remove()},inputValue:function(b){if(b===undefined){return this._value()}this.propertyChangedHandler(this,"value",this._value,b);this._refreshValue();return this},_value:function(){var b=this.numberInput.val();return b},getDecimal:function(){return this.decimal},setDecimal:function(h){if(h==null||h==undefined){h=0}if(h.toString().indexOf("e")!=-1){h=0}this.clearDecimal();var l=h.toString();var n="";var b="";var c=true;if(l.length==0){l="0"}for(i=0;i<l.length;i++){if(l.substring(i,i+1)=="."){c=false;continue}if(c){n+=l.substring(i,i+1)}else{b+=l.substring(i,i+1)}}if(n.length>0){n=parseFloat(n).toString()}var f=this.digits;if(f<n.length){n=n.substr(0,f)}var d=0;var g=this._getSeparatorPosition();var e=this._getHiddenPrefixCount();g=g+e;for(i=g;i>=0;i--){if(i<this.items.length&&this.items[i].canEdit){if(d<n.length){this.items[i].character=n.substring(n.length-d-1,n.length-d);d++}}}d=0;for(i=g;i<this.items.length;i++){if(this.items[i].canEdit){if(d<b.length){this.items[i].character=b.substring(d,d+1);d++}}}this._refreshValue()},_getSeparatorPosition:function(){var b=this._getHiddenPrefixCount();if(this.decimalSeparatorPosition>0){return this.decimalSeparatorPosition-b}return this.items.length-b},propertyChangedHandler:function(c,d,g,f){if(d=="digits"||d=="groupSize"||d=="decimalDigits"){if(f<0){throw new Exception(this.invalidArgumentExceptions[0])}}if(d=="digits"){if(f!=g){this.digits=parseInt(f)}}if(d=="decimalDigits"){if(f!=g){this.decimalDigits=parseInt(f)}}if(d=="digits"||d=="symbol"||d=="symbolPosition"||d=="groupSize"||d=="groupSeparator"||d=="decimalDigits"||d=="negativeSymbol"){var b=this.decimal;var e=this._selection();this.items=new Array();this._initializeLiterals();this.value=this._getString();this._refreshValue();this._setSelection(e.start,e.end);this.setDecimal(b)}if(d=="spinbuttons"){if(!f){this.spincontainer.css("display","none")}else{this.spincontainer.css("display","block")}this._render()}if(d=="negative"){var e=this._selection();var h=0;if(f){this.items[0].character=this.negativeSymbol[0];h=1}else{this.items[0].character="";h=-1}this._refreshValue();this._setSelection(e.start+h,e.end+h)}if(d=="decimal"){this.setDecimal(f)}if(d==="value"){this.value=f;this.setDecimal(f);this._raiseEvent(1,f)}if(d=="textAlign"){this.textAlign=f;this._render()}if(d=="disabled"){this.numberInput.attr("disabled",f)}if(d=="readOnly"){this.readOnly=f}if(d=="promptChar"){for(i=0;i<this.items.length;i++){if(this.items[i].character==this.promptChar){this.items[i].character=f}}this.promptChar=f}if(d=="width"){this.width=f;this._render()}else{if(d=="height"){this.height=f;this._render()}}},_value:function(){var b=this.value;return b},_refreshValue:function(){var e=this.value;var b=0;this.value=this._getString();e=this.value;var d="";for(i=0;i<this.items.length;i++){if(this.items[i].canEdit&&this.items[i].character!=this.promptChar){d+=this.items[i].character}if(i==this.decimalSeparatorPosition){d+=this.items[i].character}}this.decimal=d;var c=false;if(this.oldValue!==e){this.oldValue=e;this._raiseEvent(0,e);c=true}this.numberInput.val(e);if(c){this._raiseEvent(1,e)}}})})(jQuery);