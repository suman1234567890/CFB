/*
Copyright (c) 2012 jqWidgets.
http://jqwidgets.com/license/
*/

(function(a){a.jqx.jqxWidget("jqxChart","",{});a.extend(a.jqx._jqxChart.prototype,{createInstance:function(c){if(!a.jqx.dataAdapter){alert("jqxdata.js is not loaded");return}if(this.source instanceof a.jqx.dataAdapter){var d=this;var e=this.source._options;if(e==undefined||(e!=undefined&&!e.autoBind)){this.source.autoSync=false;this.source.dataBind()}if(this.source.records.length==0){this.source._downloadComplete=function(){if(d.ready){d.ready()}d.refresh()}}else{if(d.ready){d.ready()}}}this._internalRefresh();var b=this;this.host.bind("mousemove",function(g){if(this.enabled==false){return}g.preventDefault();var f=g.pageX||g.clientX||g.screenX;var j=g.pageY||g.clientY||g.screenY;var h=b.host.position();f-=h.left;j-=h.top;b.onmousemove(f,j)})},defineInstance:function(){this.source=new Array();this.seriesGroups=new Array();this.categoryAxis={}},_internalRefresh:function(){this.host.empty();var c=null;if(document.createElementNS){c=new a.jqx.svgRenderer()}else{c=new a.jqx.vmlRenderer();this._isVML=true}if(!c.init(this.host)){return}this.renderer=c;var b=this.renderer.getRect();this._render({x:1,y:1,width:b.width,height:b.height})},refresh:function(){this._internalRefresh()},_seriesTypes:["line","stackedline","stackedline100","spline","stackedspline","stackedspline100","stepline","stackedstepline","stackedstepline100","area","stackedarea","stackedarea100","splinearea","stackedsplinearea","stackedsplinearea100","steparea","stackedsteparea","stackedsteparea100","column","stackedcolumn","stackedcolumn100"],_render:function(e){this.renderer.clear();if(this._getDataLen()==0){return}this._buildStats();var s=this.padding||{left:5,top:5,right:5,bottom:5};var k=this.renderer.rect(e.x,e.y,e.width-1,e.height-1);this.renderer.setAttr(k,"fill",this.background||"white");this.renderer.setAttrs(k,{"stroke-width":1,stroke:this.borderColor||"#888888"});var D={x:s.left,y:s.top,width:e.width-s.left-s.right,height:e.height-s.top-s.bottom};var b=this.titlePadding||{left:2,top:2,right:2,bottom:2};if(this.title&&this.title.length>0){var E=this.toThemeProperty("jqx-chart-title-text",null);var t=this.renderer.measureText(this.title,0,{"class":E});this.renderer.text(this.title,D.x+b.left,D.y+b.top,D.width-(b.left+b.right),t.height,0,{"class":E},true,"center","center");D.y+=t.height;D.height-=t.height}if(this.description&&this.description.length>0){var h=this.toThemeProperty("jqx-chart-title-description",null);var t=this.renderer.measureText(this.description,0,{"class":h});this.renderer.text(this.description,D.x+b.left,D.y+b.top,D.width-(b.left+b.right),t.height,0,{"class":h},true,"center","center");D.y+=t.height;D.height-=t.height}if(this.title||this.description){D.y+=(b.bottom+b.top);D.height-=(b.bottom+b.top)}var o=D;var f=0;var l=[];for(var z=0;z<this.seriesGroups.length;z++){var v=this.seriesGroups[z].valueAxis;var q=v.axisSize;if(!q||q=="auto"){q=this._renderValueAxis(z,{x:0,y:o.y,width:o.width,height:o.height},true).width}l.push(q);f+=q;if(z>0&&q>0){f+=5}}var m=this.categoryAxis.axisSize;if(!m||m=="auto"){var r=this._renderCategoryAxis({x:0,y:0,width:10000000,height:0},true);m=r.height}var B=(this.showLegend!=false);var u=!B?{width:0,height:0}:this._renderLegend(D,true);if(D.height<m+u.height||D.width<f){return}o.height-=m+u.height;o.x+=f;o.width-=f;var d=this.categoryAxis.tickMarksColor||"#888888";if(f==0){var n=a.jqx._ptrnd(o.x);var j=this.renderer.line(n,a.jqx._ptrnd(o.y),n,a.jqx._ptrnd(o.y+o.height+5),{stroke:d,"stroke-width":1})}this._renderVerticalGridLines(o);this._renderCategoryAxis({x:o.x,y:o.y+o.height,width:o.width,height:m});if(B){this._renderLegend({x:o.x+a.jqx._ptrnd((o.width-u.width)/2),y:o.y+o.height+m,width:o.width,height:u.height})}var G=o.x-f;for(var z=0;z<this.seriesGroups.length;z++){var q=l[z];this._renderValueAxis(z,{x:G,y:o.y,width:q,height:o.height},false);this._renderHorizontalGridLines(z,o);G+=q+5}if(o.width<=0||o.height<=0){return}this._plotRect={x:o.x,y:o.y,width:o.width,height:o.height};var A=this.renderer.beginGroup();var C=this.renderer.createClipRect({x:o.x,y:o.y,width:o.width,height:o.height});this.renderer.setClip(A,C);for(var z=0;z<this.seriesGroups.length;z++){var F=this.seriesGroups[z];var y=false;for(var p in this._seriesTypes){if(this._seriesTypes[p]==F.type){y=true;break}}if(!y){alert('jqxChart: invalid series type "'+F.type+'"');continue}if(F.type.indexOf("column")!=-1){this._renderColumnSeries(z,o)}else{if(F.type.indexOf("line")!=-1||F.type.indexOf("area")!=-1){this._renderLineSeries(z,o)}}}this.renderer.endGroup();this._plotGroup=this.renderer._activeParent();if(this.enabled==false){var c=this.renderer.rect(e.x,e.y,e.width,e.height);this.renderer.setAttrs(c,{fill:"#777777",opacity:0.5,stroke:"#00FFFFFF"})}},_renderLegend:function(c,d){var p={x:c.x+3,y:c.y+3,width:c.width-6,height:c.height-6};var k={width:p.width,height:0};var h=0,f=0;var e=20;var b=0;var q=10;var A=10;for(var v=0;v<this.seriesGroups.length;v++){var w=this.seriesGroups[v];for(var u=0;u<w.series.length;u++){var n=w.series[u];var m=n.displayText||n.dataField||"";var l=n.displayTextClass;if(!l){l=this.toThemeProperty("jqx-chart-legend-text",null)}var o=this.renderer.measureText(m,0,{"class":l});if(o.height>e){e=o.height}if(h!=0){h+=A}if(h+2*q+o.width>p.width&&o.width<p.width){h=0;f+=e;e=20;b=p.width;k.heigh=f+e}if(!d){var t=this._getSeriesColor(v,u);var z=this.renderer.rect(p.x+h,p.y+f+q/2,q,q);this.renderer.setAttrs(z,{fill:t,stroke:t,"stroke-width":1});this.renderer.text(m,p.x+h+1.5*q,p.y+f,o.width,e,0,{"class":l},false,"center","center")}h+=o.width+2*q;if(b<h){b=h}}}if(d){k.height=a.jqx._ptrnd(f+e);k.width=a.jqx._ptrnd(b);return k}},_renderCategoryAxis:function(c,e){var p={width:0,height:0};var d=this.categoryAxis;if(!d){return p}var r=d.text;var g=d.tickMarksColor||"#888888";if(!e){var m=a.jqx._ptrnd(c.y);var u=this.renderer.line(a.jqx._ptrnd(c.x),m,a.jqx._ptrnd(c.x+c.width+1),m,{stroke:g,"stroke-width":1})}var A=this._getDataLen();var t=d.unitInterval;if(!t||t<=0||t>=A){t=1}var q=d["class"];if(!q){q=this.toThemeProperty("jqx-chart-axis-text",null)}var b=d.dataField;var n=0;var f=Math.round(A/t);if(f*t>A){f--}if(f<1){if(e){return p}return}var h=c.width/f;var B=d.textRotationAngle||0;for(var w=0;w<f;w++){z=w;if(t>1){z=(w)*t+t/2}ii=Math.min(A-1,Math.round(z));var v=this._getDataValue(ii,this.categoryAxis.dataField);var r=this._formatValue(v,this.categoryAxis.formatSettings,this.categoryAxis.formatFunction);if(r==""){r=(ii).toString()}if(e){var s=this.renderer.measureText(r,B,{"class":q});if(s.height>p.height){p.height=s.height}}else{this.renderer.text(r,c.x+n,c.y+0,h,c.height,B,{"class":q},true);n+=h}}if(e){p.width=a.jqx._rup(p.width);p.height=a.jqx._rup(p.height+5);return p}var j=d.showTickMarks;if(j==undefined||j){var l=d.tickMarksInterval||t;var o=Math.round(A/l);var h=c.width/o;var g=d.tickMarksColor||"#888888";for(var z=1;z<=o;z++){n=a.jqx._ptrnd(c.x+z*h);var C=this.renderer.line(n,c.y,n,c.y+4,{stroke:g,"stroke-width":1})}}},_renderVerticalGridLines:function(f){var e=this.categoryAxis;if(!e||false==e.showGridLines){return}var c=e.gridLinesInterval||10;var b=Math.round(this._getDataLen()/c);var g=f.width/b;var h=e.gridLinesColor||"#888888";for(var d=1;d<=b;d++){x=a.jqx._ptrnd(f.x+d*g);this.renderer.line(x,a.jqx._ptrnd(f.y),x,a.jqx._ptrnd(f.y+f.height),{stroke:h,"stroke-width":1})}},_renderValueAxis:function(j,c,h){var F=this.seriesGroups[j];var d=F.valueAxis;var s={width:0,height:0};var o=this._stats.seriesGroups[j];if(!o||!o.isValid||false==d.displayValueAxis){if(h){return s}return}var k=d.tickMarksColor||"#888888";var e=F.type.indexOf("stacked")!=-1&&F.type.indexOf("100")!=-1;var m=d.showTickMarks;if(m==undefined){m=true}var q=c.x+c.width;q=a.jqx._ptrnd(q);if(m&&!h){this.renderer.line(q,c.y,q,c.y+c.height+5,{stroke:k,"stroke-width":1})}if(d.description){var l=d.descriptionClass;if(!l){l=this.toThemeProperty("jqx-chart-axis-description",null)}var v=this.renderer.measureText(d.description,-90,{"class":l});if(h){s.width+=v.width+5}else{this.renderer.text(d.description,c.x+2,c.y,c.width-5,c.height,-90,{"class":l},true,"left","center");c.x+=v.width+5;c.width-=v.width+5}}var b=d.dataField;var u=o.intervals;var C=o.min;var z=o.mu;var w=c.height/u;var r=d.itemsClass;if(!r){r=this.toThemeProperty("jqx-chart-axis-text",null)}var n=c.y+c.height-w;var E=d.formatSettings;if(e&&!E){E={sufix:"%"}}var f=0;var G=d.textRotationAngle||0;for(var D=0;D<=u;D++){var A=C+D*z;var t=this._formatNumber(A,E);if(h){var v=this.renderer.measureText(t,G,{"class":r});if(f<v.width){f=v.width}}else{var H=this.renderer.text(t,c.x,n+w/2,c.width-4,w,G,{"class":r},false,"center","center")}n-=w}if(h){s.width+=f+5+(m?3:0);s.height=a.jqx._rup(c.height);s.width=a.jqx._rup(s.width);return s}if(m==undefined||m){var B=c.height/o.tickMarksIntervals;n=c.y;while(n<c.y+c.height){var p=a.jqx._ptrnd(n);this.renderer.line(q-3,p,q,p,{stroke:k,"stroke-width":1});n+=B}}},_renderHorizontalGridLines:function(k,j){var c=this.seriesGroups[k].valueAxis;if(!c||c.showGridLines==false){return}var b=c.gridLinesColor||c.tickMarksColor||"#888888";var e=this._stats.seriesGroups[k];if(!e||!e.isValid||false==c.displayValueAxis||false==c.showGridLines){return}var f=e.gridLinesIntervals;var g=j.height/f;var d=j.y;while(d<j.y+j.height-1){var h=a.jqx._ptrnd(d);this.renderer.line(a.jqx._ptrnd(j.x),h,a.jqx._ptrnd(j.x+j.width),h,{stroke:b,"stroke-width":1});d+=g}},_buildStats:function(){var D={seriesGroups:new Array()};this._stats=D;for(var z=0;z<this.seriesGroups.length;z++){var m=this.seriesGroups[z];D.seriesGroups[z]={};var c=D.seriesGroups[z];c.isValid=true;var n=-1!=m.type.indexOf("stacked");var e=n&&-1!=m.type.indexOf("100");if(e){c.psums=new Array();c.nsums=new Array()}var b=NaN,d=NaN;var B=NaN,E=NaN;var A=m.baselineValue||0;var y=this._getDataLen(z);var k=0;for(var w=0;w<y&&c.isValid;w++){var t=m.valueAxis.minValue,v=m.valueAxis.maxValue,h=0,j=0;if(typeof(t)!="number"){t=NaN}if(typeof(v)!="number"){v=NaN}for(var q=0;q<m.series.length;q++){var F=this._getDataValueAsNumber(w,m.series[q].dataField,z);if(isNaN(F)){alert("jqxChart: Data source contains invalid value at Index: "+w+", DataField: "+m.series[q].dataField);c.isValid=false;break}if((F>v||isNaN(v))&&(isNaN(m.valueAxis.maxValue)?true:F<=m.valueAxis.maxValue)){v=F}if((F<t||isNaN(t))&&(isNaN(m.valueAxis.minValue)?true:F>=m.valueAxis.minValue)){t=F}if(F>A){h+=F}else{if(F<A){j+=F}}}var p=h-j;if(k<p){k=p}if(e){c.psums[w]=h;c.nsums[w]=j}if(v>d||isNaN(d)){d=v}if(t<b||isNaN(b)){b=t}if(h>B||isNaN(B)){B=h}if(j<E||isNaN(E)){E=j}}if(e){B=B==0?0:Math.max(B,-E);E=E==0?0:Math.min(E,-B)}var r=m.valueAxis.unitInterval;if(!r){r=n?(B-E)/10:(d-b)/10}var l=m.valueAxis.tickMarksInterval||r;var C=m.valueAxis.gridLinesInterval||r;if(b<E){E=b}if(d>B){B=d}var u=a.jqx._rnd(n?E:b,r,false);var o=a.jqx._rnd(n?B:d,r,true);if(e){o=(o>0)?100:0;u=(u<0)?-100:0;r=m.valueAxis.unitInterval||10;if(r<=0||r>=100){r=10}if(l<=0||l>=100){l=10}if(C<=0||C>=100){C=10}}if(isNaN(o)||isNaN(u)||isNaN(r)){continue}var f=(o-u)/r;if(f<1){continue}c.rmax=n?B:d;c.rmin=n?E:b;c.min=u;c.max=o;c.mu=r;c.maxRange=k;c.intervals=f;c.tickMarksInterval=l;c.tickMarksIntervals=(o-u)/l;c.gridLinesInterval=C;c.gridLinesIntervals=(o-u)/C;c.scale=n?(B-E)/(o-u):(d-b)/(o-u)}},_getDataLen:function(c){var b=this.source;if(c!=undefined&&c!=-1&&this.seriesGroups[c].source){b=this.seriesGroups[c].source}if(b instanceof a.jqx.dataAdapter){b=b.records}if(b){return b.length}return 0},_getDataValue:function(b,e,d){var c=this.source;if(d!=undefined&&d!=-1){c=this.seriesGroups[d].source||c}if(c instanceof a.jqx.dataAdapter){c=c.records}if(!c||b<0||b>c.length-1){return NaN}return(e&&e!="")?c[b][e]:c[b]},_getDataValueAsNumber:function(b,e,c){var d=this._getDataValue(b,e,c);if(typeof(d)!="number"){d=parseFloat(d)}if(typeof(d)!="number"){d=undefined}return d},_renderColumnSeries:function(d,b){var l=this.seriesGroups[d];if(!l.series||l.series.length==0){return}var m=l.type.indexOf("stacked")!=-1;var c=m&&l.type.indexOf("100")!=-1;var k=this._getDataLen(d);var G=l.columnsGapPercent;if(isNaN(G)||G<0||G>100){G=50}var v=l.seriesGapPercent;if(isNaN(v)||v<0||v>100){v=20}var E=Math.max(0,k-1);var q=m?0:Math.max(0,k-1);var w=b.width/k;var t=b.width/(k+E*G/100);var D=(w-t)/2;var F=t;var e=0;if(!m&&l.series.length>1){F=t/(l.series.length+v/100*(l.series.length-1));e=(t-F*l.series.length)/(l.series.length-1)}F=a.jqx._rup(F);var u=this._calcGroupOffsets(d,b);if(!u){return}for(var r=0;r<l.series.length;r++){var z=l.series[r].dataField;var o=this._getColors(d,r);for(var A=0;A<k;A++){var H=this._getDataValueAsNumber(A,z,d);if(typeof(H)!="number"){continue}var p=A*w+D+(m?0:r*(F+e));var n=u.offsets[r][A].to;var g=u.offsets[r][A].from;var f=u.baseOffset;var B=g-n;if(Math.abs(B)<1){continue}var j={x:b.x+p,y:B>0?n:g,width:F,height:Math.abs(B)};var C;if(!m){C=this.renderer.rect(j.x,j.y,j.width,j.height)}else{C=this.renderer.rect(j.x,j.y,F,j.height)}this.renderer.setAttrs(C,{fill:o.fillColor,stroke:o.lineColor,"stroke-width":1});this._installHandlers(C,d,r,A);this._showLabel(d,r,A,j)}}},_showToolTip:function(o,n,s,p,j){if(this.showToolTips==false){return}this._hideToolTip();if(this._pointMarker){o=parseInt(this.renderer.getAttr(this._pointMarker,"cx"))+5;n=parseInt(this.renderer.getAttr(this._pointMarker,"cy"))-5}var q=this.seriesGroups[s];var k=q.series[p];var b=this._getColors(s,p);var r=this._getFormattedValue(s,p,j);var f=this._getDataValue(j,this.categoryAxis.dataField);var c=!f?j.toString():f.toString();r=(k.displayText||k.dataField||"")+", "+c+": "+r;var e=k.toolTipClass||q.toolTipClass||this.toThemeProperty("jqx-chart-tooltip-text",null);var d=k.toolTipBackground||q.toolTipBackground||"#FFFFFF";var h=k.toolTipLineColor||q.toolTipLineColor||b.lineColor;var m=this.renderer.measureText(r,0,{"class":e});m.width=m.width+5;m.height=m.height+6;rect=this.renderer.getRect();o=Math.max(o-5,rect.x);n=Math.max(n-m.height,rect.y);if(m.width>rect.width||m.height>rect.height){return}if(o+m.width>rect.x+rect.width){o=rect.x+rect.width-m.width-2}if(n+m.height>rect.y+rect.height){n=rect.y+rect.height-m.height-2}var l=this.renderer.rect(o,n,m.width,m.height);this.renderer.setAttrs(l,{fill:d,"fill-opacity":0.8,stroke:h,rx:2,ry:2,"stroke-width":1});var g=this.renderer.text(r,o,n,m.width,m.height,0,{"class":e},true,"center","center");this._toolTipElement={box:l,txt:g}},_hideToolTip:function(){if(!this._toolTipElement){return}this.renderer.removeElement(this._toolTipElement.box);this.renderer.removeElement(this._toolTipElement.txt);this._toolTipElement=undefined},_showLabel:function(r,m,c,j){var o=this.seriesGroups[r];var d=o.series[m];if(!d.showLabels&&!o.showLabels){return}var n=d.labelsAngle||o.labelsAngle||0;var p=d.labelOffset||o.labelAngle||{x:0,y:0};var l=d.formatSettings||o.formatSettings;var f=d.labelClass||o.labelClass||this.toThemeProperty("jqx-chart-label-text",null);var b=this._getDataValueAsNumber(c,d.dataField,r);if(isNaN(b)){return}var q=this._formatNumber(b,l);var k=j.width;var e=j.height;if(k==0||e==0){var g=this.renderer.measureText(q,n,{"class":f});k=j.width==0?g.width:j.width;e=j.height==0?g.height:j.height}var s=this.renderer.text(q,j.x+p.x,j.y+p.y,k,e,n,{},n!=0,"center","center");this.renderer.setAttrs(s,{"class":f});if(this._isVML){this.renderer.removeElement(s);this.renderer.getContainer()[0].appendChild(s)}},_renderLineSeries:function(g,d){var p=this.seriesGroups[g];if(!p.series||p.series.length==0){return}var K=p.type.indexOf("area")!=-1;var q=p.type.indexOf("stacked")!=-1;var e=q&&p.type.indexOf("100")!=-1;var k=p.type.indexOf("spline")!=-1;var n=p.type.indexOf("step")!=-1;if(n&&k){return}var o=this._getDataLen(g);var z=d.width/o;var j=Math.round(d.width/z);var F=Math.round(o/j);var G=this._calcGroupOffsets(g,d);if(!G){return}for(var C=p.series.length-1;C>=0;C--){var r=this._getColors(g,C);var h=p.series[C].opacity||p.opacity;if(!h||h<0||h>1){h=1}var c=p.series[C].lineWidth||p.lineWidth;if(!c||c=="auto"||isNaN(c)||c<1||c>15){c=K?2:3}var J="";var H=-1;var E=0;var L=NaN;var w=NaN;var f=NaN;var y=0;for(var t=z/2,v=0;v<j&&t<d.width;v++,z<1?t++:t+=z){i=Math.round(t/z);if(z>1){i=v}if(i>=o||i<=H){continue}H=i;if(J.length!=0){J+=" "}if(i<0||i>G.offsets[C].length-1){continue}var B=G.offsets[C][i].to;if(!K&&e){if(B<=d.y){B=d.y+1}if(B>=d.y+d.height){B=d.y+d.height-1}}t=Math.max(t,1);E=t;if(n&&!isNaN(L)&&!isNaN(w)){if(w!=B){J+=a.jqx._ptrnd(d.x+E)+","+a.jqx._ptrnd(w)+" "}}J+=a.jqx._ptrnd(d.x+E)+","+a.jqx._ptrnd(B);y++;L=E;w=B;if(isNaN(f)){f=B}this._showLabel(g,C,i,{x:a.jqx._ptrnd(d.x+E),y:a.jqx._ptrnd(B),width:0,height:0})}if(k){J=this._getBezierPoints(J)}E=d.width;var b=a.jqx._ptrnd(d.x)+","+a.jqx._ptrnd(f);var m=a.jqx._ptrnd(d.x+E)+","+a.jqx._ptrnd(B);var D=a.jqx._ptrnd(d.x)+","+(G.baseOffset);var l=a.jqx._ptrnd(d.x+E)+","+(G.baseOffset);var I=J.split(" ");var u=I[0].replace("C","");if(K){J="M "+D+" L "+u+(k?"":("L "+u+" "))+J+(k?(" L"+l+" M "+l):(" "+l+" "+D));J+=" X E"}else{if(k){J="M "+u+" "+J}else{J="M "+u+" L "+u+" "+J}}var A=this.renderer.path(J,{"stroke-width":c,stroke:r.lineColor,"fill-opacity":h,fill:K?r.fillColor:"none"});this._installHandlers(A,g,C)}},_getColors:function(f,o){var l=this.seriesGroups[f];var j=l.series[o].useGradient||l.useGradient;if(j==undefined){j=true}var h=l.type.indexOf("area")!=-1;var e=this._getSeriesColor(f,o);var n=a.jqx._adjustColor(e,1.1);var k=a.jqx._adjustColor(e,0.9);var d=a.jqx._adjustColor(n,0.9);var b=(!j||!h)?e:this.renderer._toLinearGradient(e,true,[[0,1],[100,1.5]]);var c=(!j||!h)?n:this.renderer._toLinearGradient(n,true,[[0,1],[100,1.5]]);var m=l.type.indexOf("column")!=-1;if(m&&j){b=this.renderer._toLinearGradient(e,false,[[0,1],[25,1.1],[50,1.5],[100,1]]);c=this.renderer._toLinearGradient(n,false,[[0,1],[25,1.1],[50,1.5],[100,1]])}if(!m&&!h){b=c="none"}return{baseColor:e,fillColor:b,lineColor:k,fillSelected:c,lineSelected:d}},_installHandlers:function(d,k,j,c){var b=this;var h=this.seriesGroups[k];var e=this.seriesGroups[k].series[j];var f=h.type.indexOf("line")!=-1||h.type.indexOf("area")!=-1;if(!f){this.renderer.addHandler(d,"mousemove",function(g){g.preventDefault();b._startTooltipTimer(k,j,c)})}this.renderer.addHandler(d,"mouseover",function(g){g.preventDefault();b._select(d,k,j,c);if(f){return}if(isNaN(c)){return}b._raiseEvent("mouseover",h,e,c)});this.renderer.addHandler(d,"mouseout",function(g){g.preventDefault();if(c!=undefined){b._cancelTooltipTimer()}if(f){return}b._unselect();if(isNaN(c)){return}b._raiseEvent("mouseout",h,e,c)});this.renderer.addHandler(d,"click",function(g){g.preventDefault();if(f){return}if(h.type.indexOf("column")!=-1){b._unselect()}if(isNaN(c)){return}b._raiseEvent("click",h,e,c)})},_getHorizontalOffset:function(n,j,g){var h=this._plotRect;var b=this._getDataLen(n);if(b==0){return{index:undefined,x:j}}if(j<h.x||j>h.x+h.width){return{index:undefined,x:j}}var f=h.width/b;var e=Math.round(h.width/f);var m=Math.round(b/e);var c,d=0;for(var k=f/2,l=0;l<e&&k<j-h.x-f/2;l++,f<1?k++:k+=f){d=Math.round((k)/f);if(f>1){d=l}if(d>=b||d<=c){continue}}d=Math.max(d,l);if(d>b-1){d=b-1}return{index:d,x:k}},onmousemove:function(k,h){this._mouseX=k;this._mouseY=h;this._hideToolTip();if(!this._selected){return}var j=this._plotRect;if(k<j.x||k>j.x+j.width||h<j.y||h>j.y+j.height){this._unselect();return}var m=this._selected.group;var e=this.seriesGroups[m];var o=e.series[this._selected.series];var f=this.seriesGroups[m].type;var j=this._plotRect;if(f.indexOf("line")!=-1||f.indexOf("area")!=-1){var c=this._getHorizontalOffset(m,k,h);var d=c.index;if(d==undefined){return}if(this._selected.item!=d){if(this._selected.item){this._raiseEvent("mouseout",e,o,this._selected.item)}this._selected.item=d;this._raiseEvent("mouseover",e,o,d)}var l=this._calcGroupOffsets(m,j);h=l.offsets[this._selected.series][d].to;k=c.x;h=a.jqx._ptrnd(h);k=a.jqx._ptrnd(j.x+k);if(this._isVML){h-=4;k-=4}if(k<j.x||k>j.x+j.width&&this._pointMarker){this.renderer.removeElement(this._pointMarker);this._pointMarker=undefined;return}if(!this._pointMarker){this._pointMarker=this.renderer.circle(k,h,4);this._plotGroup.appendChild(this._pointMarker)}var b=this._getSeriesColor(this._selected.group,this._selected.series);var n=a.jqx._adjustColor(b,0.7);this.renderer.setAttrs(this._pointMarker,{fill:b,stroke:n,opacity:1});this.renderer.setAttrs(this._pointMarker,{cx:k,cy:h});this._startTooltipTimer(m,this._selected.series,d)}},_startTooltipTimer:function(h,f,d){this._cancelTooltipTimer();var b=this;var e=b.seriesGroups[h];var c=this.toolTipDelay;if(isNaN(c)||c>10000||c<0){c=500}this._tttimer=setTimeout(function(){b._showToolTip(b._mouseX,b._mouseY-3,h,f,d);b._tttimer=setTimeout(function(){b._hideToolTip()},4000)},c)},_cancelTooltipTimer:function(){clearTimeout(this._tttimer)},_select:function(d,h,f,c){if(this._selected&&this._selected.element!=d){this._unselect()}this._selected={element:d,group:h,series:f,item:c};var b=this._getColors(h,f);var e=this.seriesGroups[h];this.renderer.setAttrs(d,{stroke:b.lineSelected,fill:b.fillSelected})},_unselect:function(){if(this._selected){var b=this._getColors(this._selected.group,this._selected.series);this.renderer.setAttrs(this._selected.element,{stroke:b.lineColor,fill:b.fillColor});var f=this._selected.group;var e=this.seriesGroups[f];var d=e.series[this._selected.series];var c=this._selected.item;if(e.type.indexOf("line")!=-1||e.type.indexOf("area")!=-1&&!isNaN(c)){this._raiseEvent("mouseout",e,d,c)}this._selected=undefined}if(this._pointMarker){this.renderer.removeElement(this._pointMarker);this._pointMarker=undefined}},_raiseEvent:function(e,f,d,b){var c=d[e]||f[e];var g=0;for(;g<this.seriesGroups.length;g++){if(this.seriesGroups[g]==f){break}}if(g==this.seriesGroups.length){return}if(c&&a.isFunction(c)){c({event:e,seriesGroup:f,serie:d,elementIndex:b,elementValue:this._getDataValue(b,d.dataField,g)})}},_calcGroupOffsets:function(f,b){var n=this.seriesGroups[f];if(!n.series||n.series.length==0){return}if(!this._renderData){this._renderData=new Array()}while(this._renderData.length<f+1){this._renderData.push(null)}if(this._renderData[f]!=null){return this._renderData[f]}var A=new Array();var o=n.type.indexOf("stacked")!=-1;var d=o&&n.type.indexOf("100")!=-1;var l=this._getDataLen(f);var C=n.baselineValue||0;var D=this._stats.seriesGroups[f];if(!D||!D.isValid){return}if(C>D.max){C=D.max}if(C<D.min){C=D.min}var u=d?D.maxRange:D.max-D.min;var E=b.height/u;var e=0;if(d){if(D.min*D.max<0){u/=2;e=b.y+b.height-(u+C)*E}else{e=b.y+b.height-C*E}}else{e=b.y+b.height-(C-D.min)*E}var s=new Array();var c=new Array();e=a.jqx._ptrnd(e);var g=(D.min*D.max<0)?b.height/2:b.height;for(var w=0;w<n.series.length;w++){A.push(new Array());for(var z=0;z<l;z++){var F=this._getDataValueAsNumber(z,n.series[w].dataField,f);if(isNaN(F)){continue}if(F>D.rmax){F=D.rmax}if(F<D.rmin){F=D.rmin}var m=(F>C)?s:c;var B=E*(F-C);var r=e;if(o){if(d){var p=(D.psums[z]-D.nsums[z]);if(F>C){B=(D.psums[z]/p)*g;if(D.psums[z]!=0){B*=F/D.psums[z]}}else{B=(D.nsums[z]/p)*g;if(D.nsums[z]!=0){B*=F/D.nsums[z]}}}if(isNaN(m[z])){m[z]=e}r=m[z]}B=a.jqx._ptrnd(Math.abs(B));if(w==n.series.length-1&&d){var q=0;for(var v=0;v<w;v++){q+=Math.abs(A[v][z].to-A[v][z].from)}q+=B;if(q<g){if(B>0.5){B=a.jqx._ptrnd(B+g-q)}else{var v=w-1;while(v>=0){var t=Math.abs(A[v][z].to-A[v][z].from);if(t>1){if(A[v][z].from>A[v][z].to){A[v][z].from+=g-q}break}v--}}}}if(F<C){m[z]+=B;A[w].push({from:r+1,to:r+B})}else{m[z]-=B;A[w].push({from:r,to:r-B})}}}var B=E*Math.max(D.min,C);this._renderData[f]={baseOffset:e,offsets:A};return this._renderData[f]},_getSeriesColor:function(l,c){var e=this.seriesGroups[l];var m=e.series[c];if(m.color){return m.color}var k=0;for(var d=0;d<=l;d++){for(var b in this.seriesGroups[d].series){if(d==l&&b==c){break}else{k++}}}var h=this.colorScheme;if(e.colorScheme){h=e.colorScheme;sidex=c}if(h){for(var d=0;d<this.colorSchemes.length;d++){var f=this.colorSchemes[d];if(f.name==h){while(k>f.colors.length){k-=f.colors.length;if(++d>=this.colorSchemes.length){d=0}f=this.colorSchemes[d]}return f.colors[k%f.colors.length]}}}return"#222222"},colorSchemes:[{name:"scheme01",colors:["#4572A7","#AA4643","#89A54E","#71588F","#4198AF"]},{name:"scheme02",colors:["#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8"]},{name:"scheme03",colors:["#E8601A","#FF9639","#F5BD6A","#599994","#115D6E"]},{name:"scheme04",colors:["#D02841","#FF7C41","#FFC051","#5B5F4D","#364651"]},{name:"scheme05",colors:["#25A0DA","#309B46","#8EBC00","#FF7515","#FFAE00"]},{name:"scheme06",colors:["#0A3A4A","#196674","#33A6B2","#9AC836","#D0E64B"]},{name:"scheme07",colors:["#CC6B32","#FFAB48","#FFE7AD","#A7C9AE","#888A63"]},{name:"scheme08",colors:["#2F2933","#01A2A6","#29D9C2","#BDF271","#FFFFA6"]},{name:"scheme09",colors:["#1B2B32","#37646F","#A3ABAF","#E1E7E8","#B22E2F"]},{name:"scheme10",colors:["#5A4B53","#9C3C58","#DE2B5B","#D86A41","#D2A825"]},{name:"scheme11",colors:["#993144","#FFA257","#CCA56A","#ADA072","#949681"]}],_formatValue:function(c,f,b){if(c==undefined){return""}if(this._isObject(c)&&!b){return""}if(b){if(!a.isFunction(b)){return c.toString()}try{return b(c)}catch(d){return d.message}}if(this._isNumber(c)){return this._formatNumber(c,f)}if(this._isDate(c)){return this._formatDate(c,f)}return c.toString()},_getFormattedValue:function(l,e,b,c,d){var h=this.seriesGroups[l];var n=h.series[e];var m="";var f=c,j=d;if(!j){j=n.formatFunction||h.formatFunction}if(!f){f=n.formatSettings||h.formatSettings}if(!n.formatFunction&&n.formatSettings){j=undefined}var k=this._getDataValue(b,n.dataField,l);if(k){m=this._formatValue(k,f,j)}return m||""},_isNumber:function(b){if(typeof(b)=="string"){b=parseFloat(b)}return typeof b==="number"&&isFinite(b)},_isDate:function(b){return b instanceof Date},_isBoolean:function(b){return typeof b==="boolean"},_isObject:function(b){return(b&&(typeof b==="object"||a.isFunction(b)))||false},_formatDate:function(c,b){return c.toString()},_formatNumber:function(n,e){if(!this._isNumber(n)){return n}e=e||{};var q=e.decimalSeparator||".";var o=e.thousandsSeparator||"";var m=e.prefix||"";var p=e.sufix||"";var h=e.decimalPlaces||((n*100!=parseInt(n)*100)?2:0);var l=e.negativeWithBrackets||false;var g=(n<0);if(g&&l){n*=-1}var d=n.toString();var b;var k=Math.pow(10,h);d=(Math.round(n*k)/k).toString();b=d.lastIndexOf(".");if(h>0){if(b<0){d+=q;b=d.length-1}else{if(q!=="."){d=d.replace(".",q)}}while((d.length-1-b)<h){d+="0"}}b=d.lastIndexOf(q);b=(b>-1)?b:d.length;var f=d.substring(b);var c=0;for(var j=b;j>0;j--,c++){if((c%3===0)&&(j!==b)&&(!g||(j>1)||(g&&l))){f=o+f}f=d.charAt(j-1)+f}d=f;if(g&&l){d="("+d+")"}return m+d+p},_defaultNumberFormat:{prefix:"",sufix:"",decimalSeparator:".",thousandsSeparator:",",decimalPlaces:2,negativeWithBrackets:false},_getBezierPoints:function(e){var h=[];var f=e.split(" ");for(var d=0;d<f.length;d++){var j=f[d].split(",");h.push({x:parseFloat(j[0]),y:parseFloat(j[1])})}var k="";for(var d=0;d<h.length-1;d++){var b=[];if(0==d){b.push(h[d]);b.push(h[d]);b.push(h[d+1]);b.push(h[d+2])}else{if(h.length-2==d){b.push(h[d-1]);b.push(h[d]);b.push(h[d+1]);b.push(h[d+1])}else{b.push(h[d-1]);b.push(h[d]);b.push(h[d+1]);b.push(h[d+2])}}var c=[];var g=9;c.push({x:b[1].x,y:b[1].y});c.push({x:((-b[0].x+g*b[1].x+b[2].x)/g),y:((-b[0].y+g*b[1].y+b[2].y)/g)});c.push({x:((b[1].x+g*b[2].x-b[3].x)/g),y:((b[1].y+g*b[2].y-b[3].y)/g)});c.push({x:b[2].x,y:b[2].y});k+="C"+a.jqx._ptrnd(c[1].x)+","+a.jqx._ptrnd(c[1].y)+" "+a.jqx._ptrnd(c[2].x)+","+a.jqx._ptrnd(c[2].y)+" "+a.jqx._ptrnd(c[3].x)+","+a.jqx._ptrnd(c[3].y)+" "}return k}});a.jqx._adjustColor=function(d,b){var e=a.jqx.cssToRgb(d);var d="#";for(var f=0;f<3;f++){var g=Math.round(b*e[f]);if(g>255){g=255}else{if(g<=0){g=0}}g=a.jqx.decToHex(g);if(g.toString().length==1){d+="0"}d+=g}return d.toUpperCase()};a.jqx.decToHex=function(b){return b.toString(16)},a.jqx.hexToDec=function(b){return parseInt(b,16)};a.jqx.rgbToHex=function(e,d,c){return[a.jqx.decToHex(e),a.jqx.decToHex(d),a.jqx.decToHex(c)]};a.jqx.hexToRgb=function(c,d,b){return[a.jqx.hexToDec(c),a.jqx.hexToDec(d),a.jqx.hexToDec(b)]};a.jqx.cssToRgb=function(b){if(b.indexOf("rgb")<=-1){return a.jqx.hexToRgb(b.substring(1,3),b.substring(3,5),b.substring(5,7))}return b.substring(4,b.length-1).split(",")};a.jqx._ptrnd=function(c){var b=a.jqx._rnd(c,1,false);if(!document.createElementNS){return b}return b-0.5};a.jqx._rup=function(c){var b=Math.round(c);if(c>b){b++}return b};a.jqx._rnd=function(c,e,d){if(isNaN(c)){return c}var b=c-c%e;if(c==b){return b}if(d){if(c>b){b+=e}}else{if(b>c){b-=e}}return b};a.jqx.svgRenderer=function(){};a.jqx.svgRenderer.prototype={_svgns:"http://www.w3.org/2000/svg",init:function(f){var d="<table id=tblChart cellspacing='0' cellpadding='0' border='0' align='left' valign='top'><tr><td colspan=2 id=tdTop></td></tr><tr><td id=tdLeft></td><td id='chartContainer'></td></tr></table>";f.append(d);this.host=f;var b=f.find("#chartContainer");b[0].style.width=f.width()+"px";b[0].style.height=f.height()+"px";var h;try{var c=document.createElementNS(this._svgns,"svg");c.setAttribute("id","svgChart");c.setAttribute("version","1.1");c.setAttribute("width","100%");c.setAttribute("height","100%");b[0].appendChild(c);this.canvas=c}catch(g){return false}this._id=new Date().getTime();this.clear();this._layout();this._runLayoutFix();return true},_runLayoutFix:function(){var b=this;this._fixLayout();this._tFix=setTimeout(function(){b._runLayoutFix()},1000)},_fixLayout:function(){var d=a(this.canvas).position();var c=(parseFloat(d.left)==parseInt(d.left));var b=(parseFloat(d.top)==parseInt(d.top));if(!a.browser.msie){if(!c){this.host.find("#tdLeft")[0].style.width=(this.host.find("#tdLeft")[0].style.width=="0.5px")?"0px":"0.5px"}if(!b){this.host.find("#tdTop")[0].style.height=(this.host.find("#tdTop")[0].style.height=="0.5px")?"0px":"0.5px"}}else{}},_layout:function(){var c=a(this.canvas).offset();var b=this.host.find("#chartContainer");this._width=Math.max(a.jqx._rup(this.host.width())-1,0);this._height=Math.max(a.jqx._rup(this.host.height())-1,0);b[0].style.width=this._width;b[0].style.height=this._height;this._fixLayout()},getRect:function(){return{x:0,y:0,width:this._width,height:this._height}},getContainer:function(){var b=this.host.find("#chartContainer");return b},clear:function(){while(this.canvas.childElementCount>0){this.canvas.removeChild(this.canvas.firstElementChild)}this._defs=document.createElementNS(this._svgns,"defs");this._gradients={};this.canvas.appendChild(this._defs)},removeElement:function(b){if(b!=undefined){this.canvas.removeChild(b)}},_openGroups:[],beginGroup:function(){var b=this._activeParent();var c=document.createElementNS(this._svgns,"g");b.appendChild(c);this._openGroups.push(c);return c},endGroup:function(){if(this._openGroups.length==0){return}this._openGroups.pop()},_activeParent:function(){return this._openGroups.length==0?this.canvas:this._openGroups[this._openGroups.length-1]},createClipRect:function(d){var e=document.createElementNS(this._svgns,"clipPath");var b=document.createElementNS(this._svgns,"rect");this.setAttrs(b,{x:d.x,y:d.y,width:d.width,height:d.height});this._clipId=this._clipId||0;e.id="cl"+this._id+"_"+(++this._clipId).toString();e.appendChild(b);this._defs.appendChild(e);return e},setClip:function(c,b){return this.setAttr(c,"clip-path","url(#"+b.id+")")},_clipId:0,addHandler:function(b,d,c){b["on"+d]=c},shape:function(b,e){var c=document.createElementNS(this._svgns,b);if(!c){return undefined}for(var d in e){c.setAttribute(d,e[d])}this._activeParent().appendChild(c);return c},measureText:function(l,c,d){var f=document.createElementNS(this._svgns,"text");this.setAttrs(f,d);f.appendChild(f.ownerDocument.createTextNode(l));var k=this._activeParent();k.appendChild(f);var m=f.getBBox();var g=a.jqx._rup(m.width);var b=a.jqx._rup(m.height);k.removeChild(f);if(c==0){return{width:g,height:b}}var h=c*Math.PI*2/360;var e=Math.abs(g*Math.sin(h)-b*Math.cos(h));var j=Math.abs(g*Math.cos(h)+b*Math.sin(h));return{width:a.jqx._rup(j),height:a.jqx._rup(e)}},text:function(p,m,l,t,r,A,C,B,o,g){var s;if(!o){o="center"}if(!g){g="center"}if(B){s=this.beginGroup();var e=this.createClipRect({x:a.jqx._rup(m),y:a.jqx._rup(l),width:a.jqx._rup(t),height:a.jqx._rup(r)});this.setClip(s,e)}var q=document.createElementNS(this._svgns,"text");this.setAttrs(q,C);q.appendChild(q.ownerDocument.createTextNode(p));var k=this._activeParent();k.appendChild(q);var b=q.getBBox();k.removeChild(q);var D=b.width;var j=b.height*0.66;var n=t||0;var v=r||0;if(!A||A==0){if(o=="center"){m+=(n-D)/2}else{if(o=="right"){m+=(n-D)}}if(g=="center"){l=l+v-(v-j)/2}else{if(g=="bottom"){l=l+v-j}}if(!t){t=D}if(!r){r=j}this.setAttrs(q,{x:a.jqx._rup(m),y:a.jqx._rup(l),width:a.jqx._rup(t),height:a.jqx._rup(r),cursor:"default"});k.appendChild(q);this.endGroup();return k==this.canvas?q:k}var f=A*Math.PI*2/360;var d=Math.abs(D*Math.sin(f)-j*Math.cos(f));var z=Math.abs(D*Math.cos(f)+j*Math.sin(f));if(o=="center"){m+=(n-z)/2}else{if(o=="right"){m+=(n-z)}}if(g=="center"){l=l+(v-d)/2}else{if(g=="bottom"){l=l+v-d}}if(A<0){l+=d}m+=z;m=a.jqx._rup(m);l=a.jqx._rup(l);var u=this.shape("g",{transform:"translate("+m+","+l+")"});var c=this.shape("g",{transform:"rotate("+A+")"});u.appendChild(c);c.appendChild(q);k.appendChild(u);this.endGroup();return k==this.canvas?u:k},line:function(d,f,c,e,g){var b=this.shape("line",{x1:d,y1:f,x2:c,y2:e});this.setAttrs(b,g)},path:function(c,d){var b=this.shape("path");b.setAttribute("d",c);if(d){this.setAttrs(b,d)}return b},rect:function(b,g,c,e,f){b=a.jqx._ptrnd(b);g=a.jqx._ptrnd(g);c=a.jqx._rup(c);e=a.jqx._rup(e);var d=this.shape("rect",{x:b,y:g,width:c,height:e});if(f){this.setAttrs(d,f)}return d},circle:function(b,d,c){return this.shape("circle",{cx:b,cy:d,r:c})},setAttrs:function(b,d){if(!b||!d){return}for(var c in d){b.setAttribute(c,d[c])}},setAttr:function(c,b,d){if(!c){return}c.setAttribute(b,d)},getAttr:function(c,b){return c.getAttribute(b)},_gradients:{},_toLinearGradient:function(e,g,h){var c="grd"+e.replace("#","")+(g?"v":"h");var b="url(#"+c+")";if(this._gradients[b]){return b}var d=document.createElementNS(this._svgns,"linearGradient");this.setAttrs(d,{x1:"0%",y1:"0%",x2:g?"0%":"100%",y2:g?"100%":"0%",id:c});for(var f in h){var k=document.createElementNS(this._svgns,"stop");var j="stop-color:"+a.jqx._adjustColor(e,h[f][1]);this.setAttrs(k,{offset:h[f][0]+"%",style:j});d.appendChild(k)}this._defs.appendChild(d);this._gradients[b]=true;return b},anim:function(c,b,d,h,g,f){var e=document.createElementNS("http://www.w3.org/2000/svg","animate");if(!e.beginElement){this.setAttr(c,b,g);return}e.setAttributeNS(null,"attributeName",b);e.setAttributeNS(null,"attributeType",d);e.setAttributeNS(null,"begin","indefinite");e.setAttributeNS(null,"from",h);e.setAttributeNS(null,"to",g);e.setAttributeNS(null,"dur",f);e.setAttributeNS(null,"fill","freeze");c.appendChild(e);e.beginElement()}};a.jqx.vmlRenderer=function(){};a.jqx.vmlRenderer.prototype={_vmlns:"urn:schemas-microsoft-com:vml",init:function(d){var c="<div id='chartContainer' style=\"position:relative;\"><div>";d.append(c);this.host=d;var b=d.find("#chartContainer");b[0].style.width=d.width()+"px";b[0].style.height=d.height()+"px";document.namespaces.add("v",this._vmlns);document.createStyleSheet().cssText="v\\:* { behavior: url(#default#VML); }";this.canvas=b[0];this._width=Math.max(a.jqx._rup(b.width())-2,0);this._height=Math.max(a.jqx._rup(b.height())-2,0);b[0].style.width=this._width;b[0].style.height=this._height;this._id=new Date().getTime();this.clear();return true},getRect:function(){return{x:0,y:0,width:this._width,height:this._height}},getContainer:function(){var b=this.host.find("#chartContainer");return b},clear:function(){while(this.canvas.childElementCount>0){this.canvas.removeChild(this.canvas.firstElementChild)}this._gradients={}},removeElement:function(b){b.parentNode.removeChild(b)},_openGroups:[],beginGroup:function(){var b=this._activeParent();var c=document.createElement("v:group");c.style.position="absolute";c.coordorigin="0,0";c.coordsize=this._width+","+this._height;c.style.left=0;c.style.top=0;c.style.width=this._width;c.style.height=this._height;b.appendChild(c);this._openGroups.push(c);return c},endGroup:function(){if(this._openGroups.length==0){return}this._openGroups.pop()},_activeParent:function(){return this._openGroups.length==0?this.canvas:this._openGroups[this._openGroups.length-1]},createClipRect:function(b){var c=document.createElement("div");c.style.height=b.height+"px";c.style.width=b.width+"px";c.style.position="absolute";c.style.left=b.x+"px";c.style.top=b.y+"px";c.style.overflow="hidden";this._clipId=this._clipId||0;c.id="cl"+this._id+"_"+(++this._clipId).toString();this._activeParent().appendChild(c);return c},setClip:function(c,b){if(c.parent){c.parentElement.removeChild(c)}b.appendChild(c)},_clipId:0,addHandler:function(b,d,c){a(b).bind(d,c)},measureText:function(n,c,d){var e=document.createElement("v:textbox");var l=document.createElement("span");l.appendChild(document.createTextNode(n));e.appendChild(l);if(d["class"]){l.className=d["class"]}var m=this._activeParent();m.appendChild(e);var g=a(e);var h=a.jqx._rup(g.width());var b=a.jqx._rup(g.height());m.removeChild(e);if(c==0){return{width:h,height:b}}var j=c*Math.PI*2/360;var f=Math.abs(h*Math.sin(j)-b*Math.cos(j));var k=Math.abs(h*Math.cos(j)+b*Math.sin(j));return{width:a.jqx._rup(k),height:a.jqx._rup(f)}},text:function(p,m,l,s,q,B,D,C,o,g){var t=D.stroke||"black";var r;if(!o){o="center"}if(!g){g="center"}C=false;if(C){r=this.beginGroup();var e=this.createClipRect({x:a.jqx._rup(m),y:a.jqx._rup(l),width:a.jqx._rup(s),height:a.jqx._rup(q)});this.setClip(r,e)}var b=document.createElement("v:textbox");b.style.position="absolute";var u=document.createElement("span");u.appendChild(document.createTextNode(p));if(D["class"]){u.className=D["class"]}b.appendChild(u);var k=this._activeParent();k.appendChild(b);var E=a(b).width();var j=a(b).height();k.removeChild(b);var n=s||0;var z=q||0;if(!B||B==0){if(o=="center"){m+=(n-E)/2}else{if(o=="right"){m+=(n-E)}}if(g=="center"){l=l+(z-j)/2}else{if(g=="bottom"){l=l+z-j}}if(!s){s=E}if(!q){q=j}if(!r){b.style.left=a.jqx._rup(m);b.style.top=a.jqx._rup(l);b.style.width=a.jqx._rup(s);b.style.height=a.jqx._rup(q)}k.appendChild(b);if(r){this.endGroup();return k}return b}var f=B*Math.PI*2/360;var d=Math.abs(E*Math.sin(f)-j*Math.cos(f));var A=Math.abs(E*Math.cos(f)+j*Math.sin(f));if(o=="center"){m+=(n-A)/2}else{if(o=="right"){m+=(n-A)}}if(g=="center"){l=l+(z-d)/2}else{if(g=="bottom"){l=l+z-d}}m=a.jqx._rup(m);l=a.jqx._rup(l);var v=a.jqx._rup(m+A);var c=a.jqx._rup(l+d);if(Math.abs(B)==90){k.appendChild(b);b.style.left=a.jqx._rup(m);b.style.top=a.jqx._rup(l);b.style.filter="progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";if(r){this.endGroup();return k}return b}return line},shape:function(b,e){var c=document.createElement("v:"+b);if(!c){return undefined}for(var d in e){c.setAttribute(d,e[d])}this._activeParent().appendChild(c);return c},line:function(e,g,d,f,h){var b="M "+e+","+g+" L "+d+","+f+" X E";var c=this.path(b);this.setAttrs(c,h);return c},path:function(c,e){var b=document.createElement("v:shape");b.style.position="absolute";b.coordsize=this._width+" "+this._height;b.coordorigin="0 0";b.style.width=parseInt(this._width);b.style.height=parseInt(this._height);b.style.left=0;b.style.top=0;var d=document.createElement("v:path");d.v=c;b.appendChild(d);this._activeParent().appendChild(b);if(e){this.setAttrs(b,e)}return b},rect:function(b,g,c,d,f){b=a.jqx._ptrnd(b);g=a.jqx._ptrnd(g);c=a.jqx._rup(c);d=a.jqx._rup(d);var e=this.shape("rect",f);e.style.position="absolute";e.style.left=b;e.style.top=g;e.style.width=c;e.style.height=d;e.strokeweight=0;return e},circle:function(b,e,d){var c=this.shape("oval");b=a.jqx._ptrnd(b);e=a.jqx._ptrnd(e);d=a.jqx._rup(d);c.style.position="absolute";c.style.left=b;c.style.top=e;c.style.width=d*2;c.style.height=d*2;return c},_keymap:[{svg:"fill",vml:"fillcolor"},{svg:"stroke",vml:"strokecolor"},{svg:"stroke-width",vml:"strokeweight"},{svg:"fill-opacity",vml:"fillopacity"},{svg:"opacity",vml:"opacity"},{svg:"cx",vml:"style.left"},{svg:"cy",vml:"style.top"}],_translateParam:function(b){for(var c in this._keymap){if(this._keymap[c].svg==b){return this._keymap[c].vml}}return b},setAttrs:function(c,e){if(!c||!e){return}for(var d in e){var b=this._translateParam(d);if(b=="fillcolor"&&e[d].indexOf("grd")!=-1){c.type=e[d]}else{if(b=="opacity"||b=="fillopacity"){c.fill.opacity=e[d]}else{if(b.indexOf("style.")==-1){c[b]=e[d]}else{c.style[b.replace("style.","")]=e[d]}}}}},setAttr:function(d,c,e){var b=this._translateParam(c);d[b]=e},getAttr:function(d,c){var b=this._translateParam(c);if(b=="opacity"||b=="fillopacity"){return d.fill.opacity}if(b.indexOf("style.")==-1){return d[b]}return d.style[b.replace("style.","")]},_gradients:{},_toLinearGradient:function(g,j,k){var d="grd"+g.replace("#","")+(j?"v":"h");var e="#"+d+"";if(this._gradients[e]){return e}var f=document.createElement("v:fill");f.type="gradient";f.method="linear";f.angle=j?0:90;var c="";for(var h in k){if(h>0){c+=", "}c+=k[h][0]+"% "+a.jqx._adjustColor(g,k[h][1])}f.colors=c;var b=document.createElement("v:shapetype");b.appendChild(f);b.id=d;this.canvas.appendChild(b);return e}}})(jQuery);